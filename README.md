# P2P 实时屏幕共享助手

一个轻量级的Python桌面应用程序，用于在局域网内进行低延迟的实时屏幕共享。

## 功能特点

- **对等（P2P）共享**: 每个用户既可以分享自己的屏幕，也可以观看其他人的屏幕
- **低延迟传输**: 优化的网络协议，确保流畅的观看体验
- **灵活的窗口交互**: 
  - 置顶显示，不会被其他窗口遮挡
  - 支持拖动移动
  - 鼠标悬浮自动放大，便于查看细节
- **可配置的性能**: 
  - 自定义帧率（FPS）
  - 调整JPEG压缩质量
  - 自定义窗口大小和缩放比例
- **实时性能监控**: 显示当前FPS和连接状态
- **简洁易用的界面**: 一键连接，直观的状态显示

## 安装依赖

```bash
pip install mss Pillow
```

## 使用方法

### 1. 启动程序
```bash
python main.py
```

### 2. 分享你的屏幕
程序启动后会自动开始分享你的屏幕。主窗口会显示你的IP地址，告诉其他人这个地址即可让他们连接到你。

### 3. 连接到其他人
在"连接到同伴"区域：
- 输入对方的IP地址
- 输入端口号（默认55555）
- 点击"连接"

连接成功后，会弹出一个新窗口显示对方的屏幕。

### 4. 窗口操作
- **拖动**: 直接拖动窗口来移动位置
- **缩放**: 将鼠标悬浮在窗口上自动放大，移开鼠标恢复原状
- **关闭**: 在主界面选择连接后点击"断开选中连接"

## 配置选项

点击主界面的"设置"按钮可以调整：

### 网络设置
- **默认端口**: 程序监听的端口号
- **帧率 (FPS)**: 屏幕捕获和传输的帧率
- **JPEG质量**: 图像压缩质量（1-100，数值越高质量越好但数据量越大）

### 视图设置
- **默认宽度/高度**: 观看窗口的初始大小
- **缩放比例**: 鼠标悬浮时的放大倍数

### 界面设置
- **显示FPS**: 是否在观看窗口显示实时帧率
- **显示连接状态**: 是否显示详细的连接状态信息

## 网络配置

### 局域网使用
确保所有设备连接在同一个局域网内，可以直接使用设备的IP地址连接。

### 虚拟局域网
如果要跨地域使用，建议使用虚拟局域网软件（如Hamachi、ZeroTier等）先组建虚拟内网，然后使用虚拟网络的IP地址连接。

## 故障排除

### 连接失败
1. 检查IP地址是否正确
2. 确认端口号一致
3. 检查防火墙设置，确保端口未被阻挡
4. 确认两台设备在同一网络内

### 性能问题
1. 降低帧率以减少网络负载
2. 调整JPEG质量平衡清晰度和性能
3. 减小观看窗口的默认大小

### 画面卡顿
1. 检查网络连接状况
2. 降低帧率和JPEG质量
3. 关闭其他占用网络的程序

## 文件说明

- `main.py`: 程序入口
- `control_panel.py`: 主控制界面
- `viewer_window.py`: 屏幕观看窗口
- `network_comms.py`: 网络通信模块
- `screen_capture.py`: 屏幕捕获模块
- `settings_dialog.py`: 设置对话框
- `config.json`: 配置文件
- `requirements.txt`: 依赖包列表

## 技术细节

- **屏幕捕获**: 使用MSS库进行高效的屏幕截图
- **图像压缩**: PIL/Pillow进行JPEG压缩优化
- **网络协议**: 基于TCP的自定义二进制协议
- **用户界面**: Tkinter原生界面组件
- **多线程**: 网络通信和UI更新分离，确保界面响应性